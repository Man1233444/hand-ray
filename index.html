<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mobile AR Working</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

<style>
  body {
    margin: 0;
    overflow: hidden;
    background: black;
  }

  #startScreen {
    position: fixed;
    inset: 0;
    background: white;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 10;
    text-align: center;
  }

  #startBtn {
    margin-top: 20px;
    padding: 16px 32px;
    font-size: 1.2em;
  }

  #marker {
    width: 280px;
    border: 2px solid black;
    margin-top: 10px;
  }

  a-scene {
    position: fixed !important;
    inset: 0;
    z-index: 1;
  }
</style>
</head>
<body>

<div id="startScreen">
  <h2>Print This Marker</h2>
  <img id="marker"
    src="https://raw.githubusercontent.com/hiukim/mind-ar-js/master/examples/image-tracking/assets/card-example/card.png">
  <button id="startBtn">Start AR</button>
</div>

<a-scene
  embedded
  renderer="colorManagement: true, physicallyCorrectLights"
  vr-mode-ui="enabled: false"
  device-orientation-permission-ui="enabled: true"
  mindar-image="
    imageTargetSrc: https://raw.githubusercontent.com/hiukim/mind-ar-js/master/examples/image-tracking/assets/card-example/card.mind;
    autoStart: false;
  ">

  <!-- Camera MUST exist for video -->
  <a-camera
    position="0 0 0"
    look-controls="enabled: false"
    cursor="rayOrigin: mouse">
  </a-camera>

  <!-- Marker anchor -->
  <a-entity mindar-image-target="targetIndex: 0">
    <a-box
      position="0 0 0.1"
      scale="0.3 0.3 0.3"
      color="#4CC3D9"
      animation="property: rotation; to: 0 360 0; dur: 4000; loop: true">
    </a-box>
  </a-entity>

</a-scene>

<script>
const startBtn = document.getElementById('startBtn');
const startScreen = document.getElementById('startScreen');
const sceneEl = document.querySelector('a-scene');

startBtn.onclick = async () => {
  // Fullscreen FIRST (required for camera)
  if (document.documentElement.requestFullscreen) {
    await document.documentElement.requestFullscreen();
  }

  // Hide UI AFTER fullscreen
  startScreen.style.display = 'none';

  // Force MindAR start
  await sceneEl.components['mindar-image'].start();
};
</script>

</body>
</html>
